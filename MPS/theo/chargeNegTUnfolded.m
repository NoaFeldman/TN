function res = chargeNegTUnfolded(t, a, fixed)
    l = fixed(1);
    n = fixed(2);
    K = fixed(3);
    L = fixed(4);
    Q = fixed(5);
    epsilon = abs(a(1));
    nuc = abs(a(2));
    wpm = real(a(3));
    w0 = 1;
    [w11t, w22t, w33t, w12, w12t, w23, w23t, w13, w13t] = wDiffs(l, t, epsilon, L);
    dw1 = wDerivative(l, t, epsilon, L);
    dw2 = wDerivative(0, t, epsilon, L);
    dw3 = wDerivative(-l, t, epsilon, L);
    a(2) = abs(a(2));
    order2 = 0;
    order2Shift = [0, 1, -1];
    for i = 1:3
        for j = 1:3
            for k = 1:3
                if i ~= j && i ~=k && k ~= j
                    order2 = order2 + ...
                        sndOrderIntegral(K / n .* log((nuc .* w11t).^(-2/2) .* (dw1).^(2/2)), ...
                                         K / n .* log((nuc .* w22t).^(-2/2) .* (dw2).^(2/2)), ...
                                         K / n .* log((nuc .* w33t).^(-2/2) .* (dw3).^(2/2)), ...
                                         K / n .* log((nuc .* w12).^2 .* (nuc .* w12t).^(-2)), ...
                                         K / n .* log((nuc .* w13).^2 .* (nuc .* w13t).^(-2)), ...
                                         K / n .* log((nuc .* w23).^2 .* (nuc .* w23t).^(-2)), ...
                                         order2Shift(i), order2Shift(j), order2Shift(k), Q);
                end
            end
        end
    end
    res = w0 .* (fstOrderIntegral(K / n .* log((nuc .* w11t).^(-2/2) .* (dw1).^(2/2)), ...
                                 K / n .* log((nuc .* w22t).^(-2/2) .* (dw2).^(2/2)), ...
                                 K / n .* log((nuc .* w33t).^(-2/2) .* (dw3).^(2/2)), ...
                                 K / n .* log((nuc .* w12).^2 .* (nuc .* w12t).^(-2)), ...
                                 K / n .* log((nuc .* w13).^2 .* (nuc .* w13t).^(-2)), ...
                                 K / n .* log((nuc .* w23).^2 .* (nuc .* w23t).^(-2)), ...
                                 Q) + wpm.*order2);
end

function res = fstOrderIntegral(s11, s22, s33, s12, s13, s23, Q)
res = (1/2).*exp(1).^(pi.^2.*Q.^2.*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+ ...
    s33).^(-1)).*pi.^(1/2).*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33) ...
    .^(-1/2).*(erfi((1/2).*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33).^( ...
    -1/2).*((sqrt(-1)*(-2)).*pi.*Q+s11+(-2).*s12+s13+4.*s22+(-2).*s23+ ...
    s33))+erfi((1/2).*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33).^(-1/2) ...
    .*((sqrt(-1)*2).*pi.*Q+s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33))); ...
end

function res = sndOrderIntegral(s11, s22, s33, s12, s13, s23, a1, a1t, a2, a2t, a3, a3t, Q)
      res = 
end