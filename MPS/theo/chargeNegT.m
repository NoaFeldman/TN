function res = chargeNegT(t, a, fixed)
    n = fixed(1);
    K = fixed(2);
    l = fixed(3);
    Q = fixed(4);
    epsilon = abs(a(1));
    wpm = real(a(2));
    nuc = abs(a(3));
    [w11t, w22t, w33t, w12, w12t, w23, w23t, w13, w13t] = wDiffs(l/2, t, epsilon);
    dw1 = wDerivative(l/2, t, epsilon);
    dw2 = wDerivative(0, t, epsilon);
    dw3 = wDerivative(-l/2, t, epsilon);
    order2 = 0;
    order2Shift = [0, 1, -1];
    for i = 1:3
        for j = 1:3
            for k = 1:3
                if i ~= j && i ~=k && k ~= j
                    order2 = order2 + ...
                        sndOrderIntegral(K / n .* log((nuc .* w11t).^(-4) .* (nuc .* dw1).^(4/2)), ...
                                         K / n .* log((nuc .* w22t).^(-4) .* (nuc .* dw2).^(4/2)), ...
                                         K / n .* log((nuc .* w33t).^(-4) .* (nuc .* dw3).^(4/2)), ...
                                         K / n .* log((nuc .* w12).^4 .* (nuc .* w12t).^(-4)), ...
                                         K / n .* log((nuc .* w13).^4 .* (nuc .* w13t).^(-4)), ...
                                         K / n .* log((nuc .* w23).^4 .* (nuc .* w23t).^(-4)), ...
                                         order2Shift(i), order2Shift(j), order2Shift(k), Q);
                end
            end
        end
    end
    res = fstOrderIntegral(K / n .* log((nuc .* w11t).^(-4) .* (nuc .* dw1).^(4/2)), ...
                                         K / n .* log((nuc .* w22t).^(-4) .* (nuc .* dw2).^(4/2)), ...
                                         K / n .* log((nuc .* w33t).^(-4) .* (nuc .* dw3).^(4/2)), ...
                                         K / n .* log((nuc .* w12).^4 .* (nuc .* w12t).^(-4)), ...
                                         K / n .* log((nuc .* w13).^4 .* (nuc .* w13t).^(-4)), ...
                                         K / n .* log((nuc .* w23).^4 .* (nuc .* w23t).^(-4)), ...
                                         Q) + wpm.*order2;
end

function res =fstOrderIntegral(s11, s22, s33, s12, s13, s23, Q)
res = (1/2).*exp(1).^(pi.^2.*Q.^2.*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+ ...
    s33).^(-1)).*pi.^(1/2).*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33) ...
    .^(-1/2).*(erfi((1/2).*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33).^( ...
    -1/2).*((sqrt(-1)*(-2)).*pi.*Q+s11+(-2).*s12+s13+4.*s22+(-2).*s23+ ...
    s33))+erfi((1/2).*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33).^(-1/2) ...
    .*((sqrt(-1)*2).*pi.*Q+s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33))); ...
end

function res = sndOrderIntegral(s11, s22, s33, s12, s13, s23, a1, a2, a3, Q)
      res = (-1/2).*exp(1).^((-1/4).*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33) ...
          .^(-1).*((-4).*pi.^2.*Q.^2+a2.^2.*s12.^2+2.*a2.*a3.*s12.*s13+ ...
          a3.^2.*s13.^2+(-4).*a2.^2.*s11.*s22+(-4).*a2.^2.*s13.*s22+(-8).* ...
          a2.*a3.*s13.*s22+(-4).*a2.*a3.*s11.*s23+2.*a2.^2.*s12.*s23+4.*a2.* ...
          a3.*s12.*s23+(-2).*a2.*a3.*s13.*s23+(-4).*a3.^2.*s13.*s23+a2.^2.* ...
          s23.^2+4.*a2.*a3.*s23.^2+4.*a3.^2.*s23.^2+(-4).*a3.^2.*s11.*s33+ ...
          4.*a2.*a3.*s12.*s33+8.*a3.^2.*s12.*s33+(-4).*a2.^2.*s22.*s33+(-16) ...
          .*a2.*a3.*s22.*s33+(-16).*a3.^2.*s22.*s33+a1.^2.*(4.*s12.^2+(-4).* ...
          s12.*s13+s13.^2+(-4).*s11.*(4.*s22+(-2).*s23+s33))+(sqrt(-1)*(-4)) ...
          .*pi.*Q.*(a1.*(2.*s11+(-2).*s12+s13)+a2.*(s12+(-4).*s22+s23)+a3.*( ...
          s13+(-2).*s23+2.*s33))+2.*a1.*(a3.*((-1).*s13.^2+(-8).*s13.*s22+( ...
          -4).*s11.*s23+2.*s13.*s23+2.*s12.*(s13+2.*s23+(-2).*s33)+4.*s11.* ...
          s33)+a2.*(2.*s12.^2+(-1).*(2.*s11+s13).*(4.*s22+(-1).*s23)+(-1).* ...
          s12.*(s13+(-2).*s23+2.*s33))))).*pi.^(1/2).*(s11+(-2).*s12+s13+4.* ...
          s22+(-2).*s23+s33).^(-1/2).*erfi((1/2).*(s11+(-2).*s12+s13+4.*s22+ ...
          (-2).*s23+s33).^(-1/2).*((sqrt(-1)*(-2)).*pi.*Q+(-1).*s11+2.*s12+ ...
          a2.*s12+(-1).*s13+a3.*s13+a1.*(2.*s11+(-2).*s12+s13)+(-4).*s22+( ...
          -4).*a2.*s22+2.*s23+a2.*s23+(-2).*a3.*s23+(-1).*s33+2.*a3.*s33))+( ...
          1/2).*exp(1).^((-1/4).*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33).^( ...
          -1).*((-4).*pi.^2.*Q.^2+a2.^2.*s12.^2+2.*a2.*a3.*s12.*s13+a3.^2.* ...
          s13.^2+(-4).*a2.^2.*s11.*s22+(-4).*a2.^2.*s13.*s22+(-8).*a2.*a3.* ...
          s13.*s22+(-4).*a2.*a3.*s11.*s23+2.*a2.^2.*s12.*s23+4.*a2.*a3.* ...
          s12.*s23+(-2).*a2.*a3.*s13.*s23+(-4).*a3.^2.*s13.*s23+a2.^2.* ...
          s23.^2+4.*a2.*a3.*s23.^2+4.*a3.^2.*s23.^2+(-4).*a3.^2.*s11.*s33+ ...
          4.*a2.*a3.*s12.*s33+8.*a3.^2.*s12.*s33+(-4).*a2.^2.*s22.*s33+(-16) ...
          .*a2.*a3.*s22.*s33+(-16).*a3.^2.*s22.*s33+a1.^2.*(4.*s12.^2+(-4).* ...
          s12.*s13+s13.^2+(-4).*s11.*(4.*s22+(-2).*s23+s33))+(sqrt(-1)*(-4)) ...
          .*pi.*Q.*(a1.*(2.*s11+(-2).*s12+s13)+a2.*(s12+(-4).*s22+s23)+a3.*( ...
          s13+(-2).*s23+2.*s33))+2.*a1.*(a3.*((-1).*s13.^2+(-8).*s13.*s22+( ...
          -4).*s11.*s23+2.*s13.*s23+2.*s12.*(s13+2.*s23+(-2).*s33)+4.*s11.* ...
          s33)+a2.*(2.*s12.^2+(-1).*(2.*s11+s13).*(4.*s22+(-1).*s23)+(-1).* ...
          s12.*(s13+(-2).*s23+2.*s33))))).*pi.^(1/2).*(s11+(-2).*s12+s13+4.* ...
          s22+(-2).*s23+s33).^(-1/2).*erfi((1/2).*(s11+(-2).*s12+s13+4.*s22+ ...
          (-2).*s23+s33).^(-1/2).*((sqrt(-1)*(-2)).*pi.*Q+s11+(-2).*s12+a2.* ...
          s12+s13+a3.*s13+a1.*(2.*s11+(-2).*s12+s13)+4.*s22+(-4).*a2.*s22+( ...
          -2).*s23+a2.*s23+(-2).*a3.*s23+s33+2.*a3.*s33));
end