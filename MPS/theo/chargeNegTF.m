function res = chargeNegTF(t, a, fixed)
    l = fixed(1);
    n = fixed(2);
    K = fixed(3);
    L = fixed(4);
    Q = fixed(5);
    epsilon = 1;
    [w11t, w22t, w33t, w12, w12t, w23, w23t, w13, w13t] = wDiffs(l, t, epsilon, L);
    dw1 = wDerivative(l, t, epsilon, L);
    dw2 = wDerivative(0, t, epsilon, L);
    dw3 = wDerivative(-l, t, epsilon, L);
    res = (fstOrderIntegral(K / n .* log((w11t).^(-2/2) .* (dw1).^(2/2)) - a(1), ...
                                 K / n .* log((w22t).^(-2/2) .* (dw2).^(2/2)), ...
                                 K / n .* log((w33t).^(-2/2) .* (dw3).^(2/2)), ...
                                 K / n .* log((w12).^2 .* (w12t).^(-2)), ...
                                 K / n .* log((w13).^2 .* (w13t).^(-2)), ...
                                 K / n .* log((w23).^2 .* (w23t).^(-2)), ...
                                 Q) + ...
           a(3) .* fstOrderIntegral(K / n .* log((w11t).^(-2/2) .* (dw1).^(2/2)) + a(2), ...
                                 K / n .* log((w22t).^(-2/2) .* (dw2).^(2/2)), ...
                                 K / n .* log((w33t).^(-2/2) .* (dw3).^(2/2)), ...
                                 K / n .* log((w12).^2 .* (w12t).^(-2)), ...
                                 K / n .* log((w13).^2 .* (w13t).^(-2)), ...
                                 K / n .* log((w23).^2 .* (w23t).^(-2)), ...
                                 Q)) ./ (1 + a(3));
end

function res =fstOrderIntegral(s11, s22, s33, s12, s13, s23, Q)
res = (1/2).*exp(1).^(pi.^2.*Q.^2.*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+ ...
    s33).^(-1)).*pi.^(1/2).*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33) ...
    .^(-1/2).*(erfi((1/2).*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33).^( ...
    -1/2).*((sqrt(-1)*(-2)).*pi.*Q+s11+(-2).*s12+s13+4.*s22+(-2).*s23+ ...
    s33))+erfi((1/2).*(s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33).^(-1/2) ...
    .*((sqrt(-1)*2).*pi.*Q+s11+(-2).*s12+s13+4.*s22+(-2).*s23+s33))); ...
end
